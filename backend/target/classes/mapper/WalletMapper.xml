<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.usdttrading.repository.WalletMapper">

    <!-- 查找余额大于指定金额的钱包 -->
    <select id="findWalletsWithBalance" resultType="com.usdttrading.entity.Wallet">
        SELECT * FROM wallets 
        WHERE currency = #{currency} 
          AND balance >= #{minBalance} 
          AND is_active = 1 
          AND deleted = 0
        ORDER BY balance DESC
    </select>

    <!-- 更新钱包余额 -->
    <update id="updateBalance">
        UPDATE wallets 
        SET balance = #{balance}, 
            frozen_balance = #{frozenBalance},
            updated_at = NOW()
        WHERE id = #{id} AND deleted = 0
    </update>

</mapper>