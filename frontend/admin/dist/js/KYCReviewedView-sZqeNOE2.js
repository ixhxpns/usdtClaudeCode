var P=Object.defineProperty,O=Object.defineProperties;var q=Object.getOwnPropertyDescriptors;var N=Object.getOwnPropertySymbols;var W=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable;var $=(v,i,o)=>i in v?P(v,i,{enumerable:!0,configurable:!0,writable:!0,value:o}):v[i]=o,D=(v,i)=>{for(var o in i||(i={}))W.call(i,o)&&$(v,o,i[o]);if(N)for(var o of N(i))G.call(i,o)&&$(v,o,i[o]);return v},L=(v,i)=>O(v,q(i));var R=(v,i,o)=>new Promise((_,c)=>{var y=l=>{try{m(o.next(l))}catch(u){c(u)}},f=l=>{try{m(o.throw(l))}catch(u){c(u)}},m=l=>l.done?_(l.value):Promise.resolve(l.value).then(y,f);m((o=o.apply(v,i)).next())});import{k as H,ak as J,r as k,M as Q,c as X,e as Z,l as d,m as r,q as t,C as p,B as x,am as tt,a6 as V,W as et,F as st,Y as lt,K as nt,E as at}from"./vue-vendor-DL5bj91p.js";import{A as Y}from"./admin-DGuZcCEp.js";import{a3 as n,s as S}from"./element-plus--BWWjcce.js";import{_ as ot}from"./index-CtT-RS4Y.js";const it={class:"kyc-reviewed-view"},ut={class:"filter-section"},dt={class:"filter-row"},rt={class:"filter-group"},vt={class:"filter-group"},ct={class:"filter-group"},pt={class:"table-section"},mt={class:"table-container"},bt={class:"data-table"},kt={class:"user-info"},wt={class:"user-name"},_t={class:"user-id"},yt={class:"user-email"},ft={key:0,class:"review-note"},gt={key:1,class:"rejection-reason"},Ct={class:"action-buttons"},ht=["onClick"],Dt=["onClick"],Rt={key:0,class:"loading-state"},xt={key:1,class:"empty-state"},It={key:0,class:"pagination"},Kt=["disabled"],jt={class:"pagination-info"},At=["disabled"],Mt={key:0,class:"modal-body"},Nt={class:"detail-section"},$t={class:"detail-grid"},Lt={class:"detail-item"},Vt={class:"detail-item"},Yt={class:"detail-item"},St={class:"detail-item"},Ut={class:"detail-section"},Bt={class:"detail-grid"},zt={class:"detail-item"},Tt={class:"detail-item"},Et={class:"detail-item"},Ft={class:"detail-item"},Pt={key:0,class:"detail-section"},Ot={key:1,class:"detail-section"},qt={key:2,class:"detail-section"},Wt={class:"risk-info"},Gt={class:"risk-score"},Ht={class:"risk-level"},Jt=H({__name:"KYCReviewedView",setup(v){const i=J(),o=k(!1),_=k([]),c=k(1),y=k(20),f=k(0),m=k(!1),l=k(null),u=Q({status:"",reviewDate:"",userId:""}),I=X(()=>Math.ceil(f.value/y.value)),b=()=>R(this,null,function*(){o.value=!0;try{const a=D({page:c.value,pageSize:y.value},u),e=yield Y.getReviewedKyc(a);e.success&&(_.value=e.data.records||[],f.value=e.data.total||0)}catch(a){console.error("加载KYC审核记录失败:",a)}finally{o.value=!1}}),U=()=>{u.status="",u.reviewDate="",u.userId="",c.value=1,b()},K=a=>{c.value=a,b()},B=a=>{l.value=a,m.value=!0},h=()=>{m.value=!1,l.value=null},z=a=>{i.push(`/kyc/review/${a.id}`)},T=()=>R(this,null,function*(){try{const a=L(D({},u),{export:!0}),e=yield Y.exportReviewedKyc(a),C=new Blob([e.data],{type:"application/vnd.ms-excel"}),s=window.URL.createObjectURL(C),w=document.createElement("a");w.href=s,w.download=`kyc_reviewed_${new Date().getTime()}.xlsx`,w.click(),window.URL.revokeObjectURL(s)}catch(a){console.error("导出失败:",a)}}),g=a=>a?new Date(a).toLocaleString("zh-CN"):"-",j=a=>({approved:"已通过",rejected:"已拒绝",completed:"已完成"})[a]||a,E=a=>a?a.replace(/(\d{6})\d{8}(\d{4})/,"$1********$2"):"-";return Z(()=>{b()}),(a,e)=>{var C;return r(),d("div",it,[e[29]||(e[29]=t("div",{class:"page-header"},[t("h1",null,"KYC审核记录"),t("p",{class:"page-description"},"查看已完成的KYC审核记录")],-1)),t("div",ut,[t("div",dt,[t("div",rt,[e[7]||(e[7]=t("label",null,"审核状态:",-1)),x(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>u.status=s),onChange:b},[...e[6]||(e[6]=[t("option",{value:""},"全部",-1),t("option",{value:"approved"},"已通过",-1),t("option",{value:"rejected"},"已拒绝",-1)])],544),[[tt,u.status]])]),t("div",vt,[e[8]||(e[8]=t("label",null,"审核时间:",-1)),x(t("input",{type:"date","onUpdate:modelValue":e[1]||(e[1]=s=>u.reviewDate=s),onChange:b},null,544),[[V,u.reviewDate]])]),t("div",ct,[e[9]||(e[9]=t("label",null,"用户ID:",-1)),x(t("input",{type:"text","onUpdate:modelValue":e[2]||(e[2]=s=>u.userId=s),onKeyup:et(b,["enter"]),placeholder:"输入用户ID"},null,544),[[V,u.userId]])]),t("button",{onClick:b,class:"btn btn-primary"},"搜索"),t("button",{onClick:U,class:"btn btn-secondary"},"重置")])]),t("div",pt,[t("div",{class:"table-header"},[e[10]||(e[10]=t("h3",null,"审核记录列表",-1)),t("div",{class:"table-actions"},[t("button",{onClick:T,class:"btn btn-outline"},"导出")])]),t("div",mt,[t("table",bt,[e[12]||(e[12]=t("thead",null,[t("tr",null,[t("th",null,"KYC ID"),t("th",null,"用户信息"),t("th",null,"提交时间"),t("th",null,"审核时间"),t("th",null,"审核结果"),t("th",null,"审核人员"),t("th",null,"备注"),t("th",null,"操作")])],-1)),t("tbody",null,[(r(!0),d(st,null,lt(_.value,s=>{var w,A,M;return r(),d("tr",{key:s.id},[t("td",null,n(s.id),1),t("td",null,[t("div",kt,[t("div",wt,n((w=s.user)==null?void 0:w.username),1),t("div",_t,"ID: "+n(s.userId),1),t("div",yt,n((A=s.user)==null?void 0:A.email),1)])]),t("td",null,n(g(s.createdAt)),1),t("td",null,n(g(s.reviewedAt)),1),t("td",null,[t("span",{class:S(["status-badge",`status-${s.status}`])},n(j(s.status)),3)]),t("td",null,n(((M=s.reviewer)==null?void 0:M.username)||"系统"),1),t("td",null,[s.reviewNote?(r(),d("div",ft,n(s.reviewNote),1)):p("",!0),s.rejectionReason?(r(),d("div",gt,[e[11]||(e[11]=t("strong",null,"拒绝原因:",-1)),at(" "+n(s.rejectionReason),1)])):p("",!0)]),t("td",null,[t("div",Ct,[t("button",{onClick:F=>B(s),class:"btn btn-sm btn-primary"}," 查看详情 ",8,ht),s.status==="rejected"?(r(),d("button",{key:0,onClick:F=>z(s),class:"btn btn-sm btn-outline"}," 重新审核 ",8,Dt)):p("",!0)])])])}),128))])]),o.value?(r(),d("div",Rt,[...e[13]||(e[13]=[t("div",{class:"loading-spinner"},null,-1),t("p",null,"加载中...",-1)])])):p("",!0),!o.value&&_.value.length===0?(r(),d("div",xt,[...e[14]||(e[14]=[t("p",null,"暂无审核记录",-1)])])):p("",!0)]),f.value>y.value?(r(),d("div",It,[t("button",{onClick:e[3]||(e[3]=s=>K(c.value-1)),disabled:c.value<=1,class:"btn btn-outline btn-sm"}," 上一页 ",8,Kt),t("span",jt," 第 "+n(c.value)+" 页，共 "+n(I.value)+" 页 ",1),t("button",{onClick:e[4]||(e[4]=s=>K(c.value+1)),disabled:c.value>=I.value,class:"btn btn-outline btn-sm"}," 下一页 ",8,At)])):p("",!0)]),m.value?(r(),d("div",{key:0,class:"modal-overlay",onClick:h},[t("div",{class:"modal-content",onClick:e[5]||(e[5]=nt(()=>{},["stop"]))},[t("div",{class:"modal-header"},[e[15]||(e[15]=t("h3",null,"KYC审核详情",-1)),t("button",{onClick:h,class:"btn-close"},"×")]),l.value?(r(),d("div",Mt,[t("div",Nt,[e[20]||(e[20]=t("h4",null,"用户信息",-1)),t("div",$t,[t("div",Lt,[e[16]||(e[16]=t("label",null,"用户ID:",-1)),t("span",null,n(l.value.userId),1)]),t("div",Vt,[e[17]||(e[17]=t("label",null,"真实姓名:",-1)),t("span",null,n(l.value.realName),1)]),t("div",Yt,[e[18]||(e[18]=t("label",null,"证件号码:",-1)),t("span",null,n(E(l.value.idNumber)),1)]),t("div",St,[e[19]||(e[19]=t("label",null,"国籍:",-1)),t("span",null,n(l.value.nationality),1)])])]),t("div",Ut,[e[25]||(e[25]=t("h4",null,"审核信息",-1)),t("div",Bt,[t("div",zt,[e[21]||(e[21]=t("label",null,"提交时间:",-1)),t("span",null,n(g(l.value.createdAt)),1)]),t("div",Tt,[e[22]||(e[22]=t("label",null,"审核时间:",-1)),t("span",null,n(g(l.value.reviewedAt)),1)]),t("div",Et,[e[23]||(e[23]=t("label",null,"审核结果:",-1)),t("span",{class:S(["status-badge",`status-${l.value.status}`])},n(j(l.value.status)),3)]),t("div",Ft,[e[24]||(e[24]=t("label",null,"审核人员:",-1)),t("span",null,n(((C=l.value.reviewer)==null?void 0:C.username)||"系统"),1)])])]),l.value.reviewNote?(r(),d("div",Pt,[e[26]||(e[26]=t("h4",null,"审核备注",-1)),t("p",null,n(l.value.reviewNote),1)])):p("",!0),l.value.rejectionReason?(r(),d("div",Ot,[e[27]||(e[27]=t("h4",null,"拒绝原因",-1)),t("p",null,n(l.value.rejectionReason),1)])):p("",!0),l.value.riskAssessment?(r(),d("div",qt,[e[28]||(e[28]=t("h4",null,"风险评估",-1)),t("div",Wt,[t("div",Gt," 风险分数: "+n(l.value.riskAssessment.riskScore),1),t("div",Ht," 风险等级: "+n(l.value.riskAssessment.riskLevel),1)])])):p("",!0)])):p("",!0),t("div",{class:"modal-footer"},[t("button",{onClick:h,class:"btn btn-secondary"},"关闭")])])])):p("",!0)])}}}),se=ot(Jt,[["__scopeId","data-v-a840c5f1"]]);export{se as default};
