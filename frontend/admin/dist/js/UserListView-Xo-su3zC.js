var Te=Object.defineProperty,Pe=Object.defineProperties;var Ne=Object.getOwnPropertyDescriptors;var j=Object.getOwnPropertySymbols;var Ye=Object.prototype.hasOwnProperty,xe=Object.prototype.propertyIsEnumerable;var $=(V,m,u)=>m in V?Te(V,m,{enumerable:!0,configurable:!0,writable:!0,value:u}):V[m]=u,F=(V,m)=>{for(var u in m||(m={}))Ye.call(m,u)&&$(V,u,m[u]);if(j)for(var u of j(m))xe.call(m,u)&&$(V,u,m[u]);return V},H=(V,m)=>Pe(V,Ne(m));var b=(V,m,u)=>new Promise((N,w)=>{var h=f=>{try{_(u.next(f))}catch(k){w(k)}},p=f=>{try{_(u.throw(f))}catch(k){w(k)}},_=f=>f.done?N(f.value):Promise.resolve(f.value).then(h,p);_((u=u.apply(V,m)).next())});/* empty css             *//* empty css                   *//* empty css                *//* empty css                       *//* empty css               *//* empty css               *//* empty css                 *//* empty css                  *//* empty css                        *//* empty css                         *//* empty css                  *//* empty css                */import"./el-form-item-l0sNRNKZ.js";import{k as Le,ak as ze,r as I,M as z,e as Me,l as Be,m as A,G as e,z as T,C as q,A as t,K as Re,E as r,u as d,q as o,B as Oe}from"./vue-vendor-DL5bj91p.js";import{u as Ke,_ as je}from"./index-CtT-RS4Y.js";import{$ as $e,V as Fe,W as He,ac as qe,ad as Ge,ae as Je,_ as Ze,U as We,af as Xe,ag as Qe,ah as ea,ai as aa,aj as ta,a3 as y,X as G,ak as la,a8 as sa,al as J,am as oa,an as ra,ao as na,aa as da,ab as ua,a2 as Z,ap as ia,aq as ca,ar as ma,as as pa,at as _a,Y as W,au as X,av as fa,aw as Q,ax as va,ay as ga,az as ba,L as i,aA as P}from"./element-plus--BWWjcce.js";const ya={class:"user-list-view"},Va={class:"stat-content"},wa={class:"stat-value"},Ea={class:"stat-icon"},Ca={class:"stat-content"},Ua={class:"stat-value"},Da={class:"stat-icon"},ka={class:"stat-content"},ha={class:"stat-value"},Sa={class:"stat-icon"},Ia={class:"stat-content"},Aa={class:"stat-value"},Ta={class:"stat-icon"},Pa={class:"table-header"},Na={class:"table-actions"},Ya={class:"user-info"},xa={class:"user-details"},La={class:"username"},za={class:"email"},Ma={class:"phone-info"},Ba={class:"pagination-wrapper"},Ra={class:"batch-info"},Oa={class:"batch-buttons"},Ka=Le({__name:"UserListView",setup(V){const m=ze();Ke();const u=I(!1),N=I([]),w=I([]),h=I(null),p=z({userId:"",username:"",email:"",status:"",kycStatus:""}),_=z({currentPage:1,pageSize:20,total:0}),f=z({totalUsers:0,activeUsers:0,kycApprovedUsers:0,newUsersToday:0}),k=I(!1),M=I(!1),Y=I(),v=z({username:"",email:"",password:"",realName:"",phone:"",status:"ACTIVE"}),ee={username:[{required:!0,message:"請輸入用戶名",trigger:"blur"},{min:3,max:20,message:"用戶名長度應在3-20個字符之間",trigger:"blur"}],email:[{required:!0,message:"請輸入郵箱",trigger:"blur"},{type:"email",message:"請輸入有效的郵箱地址",trigger:"blur"}],password:[{required:!0,message:"請輸入密碼",trigger:"blur"},{min:8,message:"密碼長度至少8位",trigger:"blur"}]},ae=s=>{switch(s){case"ACTIVE":return"success";case"DISABLED":return"warning";case"LOCKED":return"danger";default:return"info"}},te=s=>{switch(s){case"ACTIVE":return"正常";case"DISABLED":return"禁用";case"LOCKED":return"鎖定";default:return"未知"}},le=s=>{switch(s){case"APPROVED":return"success";case"PENDING":return"warning";case"REJECTED":return"danger";default:return"info"}},se=s=>{switch(s){case"NOT_SUBMITTED":return"未提交";case"PENDING":return"待審核";case"APPROVED":return"已通過";case"REJECTED":return"已拒絕";default:return"未知"}},n=()=>b(this,null,function*(){var s,a;try{u.value=!0;const E=H(F({page:_.currentPage,pageSize:_.pageSize},p),{startDate:(s=h.value)==null?void 0:s[0],endDate:(a=h.value)==null?void 0:a[1]});re()}catch(E){i.error(E.message||"載入用戶列表失敗")}finally{u.value=!1}}),oe=()=>b(this,null,function*(){try{Object.assign(f,{totalUsers:2845,activeUsers:2630,kycApprovedUsers:1892,newUsersToday:23})}catch(s){console.error("載入統計信息失敗:",s)}}),re=()=>{N.value=[{id:1,username:"john_doe",email:"john@example.com",realName:"John Doe",phone:"+1234567890",phoneVerified:!0,status:"ACTIVE",kycStatus:"APPROVED",createdAt:"2024-01-15T10:30:00Z",lastLoginAt:"2024-01-20T15:45:00Z",avatar:""},{id:2,username:"jane_smith",email:"jane@example.com",realName:"Jane Smith",phone:"+9876543210",phoneVerified:!1,status:"DISABLED",kycStatus:"PENDING",createdAt:"2024-01-14T09:20:00Z",lastLoginAt:"2024-01-19T11:30:00Z",avatar:""}],_.total=2},ne=()=>{Object.assign(p,{userId:"",username:"",email:"",status:"",kycStatus:""}),h.value=null,_.currentPage=1,n()},de=s=>{w.value=s},ue=({prop:s,order:a})=>{n()},ie=s=>{m.push(`/users/detail/${s.id}`)},ce=(s,a)=>b(this,null,function*(){switch(s){case"edit":break;case"disable":yield me(a);break;case"enable":yield pe();break;case"resetPassword":yield _e(a);break;case"delete":yield fe(a);break}}),me=s=>b(this,null,function*(){try{yield P.confirm(`確定要禁用用戶 "${s.username}" 嗎？`,"確認操作"),i.success("用戶已禁用"),n()}catch(a){a!=="cancel"&&i.error(a.message||"禁用用戶失敗")}}),pe=s=>b(this,null,function*(){try{i.success("用戶已啟用"),n()}catch(a){i.error(a.message||"啟用用戶失敗")}}),_e=s=>b(this,null,function*(){try{yield P.confirm(`確定要重置用戶 "${s.username}" 的密碼嗎？`,"確認操作"),i.success("密碼重置成功，新密碼已發送至用戶郵箱")}catch(a){a!=="cancel"&&i.error(a.message||"重置密碼失敗")}}),fe=s=>b(this,null,function*(){try{yield P.confirm(`確定要刪除用戶 "${s.username}" 嗎？此操作不可撤銷！`,"危險操作",{type:"error"}),i.success("用戶已刪除"),n()}catch(a){a!=="cancel"&&i.error(a.message||"刪除用戶失敗")}}),ve=()=>{k.value=!0},ge=()=>b(this,null,function*(){if(Y.value)try{if(!(yield Y.value.validate()))return;M.value=!0,i.success("用戶創建成功"),k.value=!1,n(),Y.value.resetFields()}catch(s){i.error(s.message||"創建用戶失敗")}finally{M.value=!1}}),be=()=>b(this,null,function*(){try{i.success("用戶數據導出中，請稍後查看下載文件")}catch(s){i.error(s.message||"導出失敗")}}),ye=()=>b(this,null,function*(){try{yield P.confirm(`確定要禁用選中的 ${w.value.length} 個用戶嗎？`,"批量操作");const s=w.value.map(a=>a.id);i.success("批量禁用成功"),n()}catch(s){s!=="cancel"&&i.error(s.message||"批量禁用失敗")}}),Ve=()=>b(this,null,function*(){try{const s=w.value.map(a=>a.id);i.success("批量啟用成功"),n()}catch(s){i.error(s.message||"批量啟用失敗")}}),we=()=>b(this,null,function*(){try{yield P.confirm(`確定要刪除選中的 ${w.value.length} 個用戶嗎？此操作不可撤銷！`,"危險操作",{type:"error"});const s=w.value.map(a=>a.id);i.success("批量刪除成功"),n()}catch(s){s!=="cancel"&&i.error(s.message||"批量刪除失敗")}});return Me(()=>{n(),oe()}),(s,a)=>{const E=He,g=Fe,C=Ge,B=qe,Ee=Je,c=We,U=Ze,O=$e,S=aa,x=ta,Ce=oa,D=na,Ue=da,R=ua,L=pa,De=ma,ke=ia,he=ra,Se=ga,Ie=ba,Ae=va;return A(),Be("div",ya,[e(S,{class:"filter-card",shadow:"never"},{default:t(()=>[e(O,{model:p,inline:"","label-width":"80px",onSubmit:Re(n,["prevent"])},{default:t(()=>[e(g,{label:"用戶ID"},{default:t(()=>[e(E,{modelValue:p.userId,"onUpdate:modelValue":a[0]||(a[0]=l=>p.userId=l),placeholder:"請輸入用戶ID",clearable:"",onClear:n},null,8,["modelValue"])]),_:1}),e(g,{label:"用戶名"},{default:t(()=>[e(E,{modelValue:p.username,"onUpdate:modelValue":a[1]||(a[1]=l=>p.username=l),placeholder:"請輸入用戶名",clearable:"",onClear:n},null,8,["modelValue"])]),_:1}),e(g,{label:"郵箱"},{default:t(()=>[e(E,{modelValue:p.email,"onUpdate:modelValue":a[2]||(a[2]=l=>p.email=l),placeholder:"請輸入郵箱",clearable:"",onClear:n},null,8,["modelValue"])]),_:1}),e(g,{label:"狀態"},{default:t(()=>[e(B,{modelValue:p.status,"onUpdate:modelValue":a[3]||(a[3]=l=>p.status=l),placeholder:"選擇用戶狀態",clearable:"",onClear:n},{default:t(()=>[e(C,{label:"全部",value:""}),e(C,{label:"正常",value:"ACTIVE"}),e(C,{label:"禁用",value:"DISABLED"}),e(C,{label:"鎖定",value:"LOCKED"})]),_:1},8,["modelValue"])]),_:1}),e(g,{label:"KYC狀態"},{default:t(()=>[e(B,{modelValue:p.kycStatus,"onUpdate:modelValue":a[4]||(a[4]=l=>p.kycStatus=l),placeholder:"選擇KYC狀態",clearable:"",onClear:n},{default:t(()=>[e(C,{label:"全部",value:""}),e(C,{label:"未提交",value:"NOT_SUBMITTED"}),e(C,{label:"待審核",value:"PENDING"}),e(C,{label:"已通過",value:"APPROVED"}),e(C,{label:"已拒絕",value:"REJECTED"})]),_:1},8,["modelValue"])]),_:1}),e(g,{label:"註冊時間"},{default:t(()=>[e(Ee,{modelValue:h.value,"onUpdate:modelValue":a[5]||(a[5]=l=>h.value=l),type:"datetimerange","range-separator":"至","start-placeholder":"開始日期","end-placeholder":"結束日期",format:"YYYY-MM-DD HH:mm:ss","value-format":"YYYY-MM-DD HH:mm:ss",onChange:n},null,8,["modelValue"])]),_:1}),e(g,null,{default:t(()=>[e(U,{type:"primary",onClick:n},{default:t(()=>[e(c,null,{default:t(()=>[e(d(Xe))]),_:1}),a[16]||(a[16]=r(" 搜索 ",-1))]),_:1}),e(U,{onClick:ne},{default:t(()=>[e(c,null,{default:t(()=>[e(d(Qe))]),_:1}),a[17]||(a[17]=r(" 重置 ",-1))]),_:1}),e(U,{type:"success",onClick:be},{default:t(()=>[e(c,null,{default:t(()=>[e(d(ea))]),_:1}),a[18]||(a[18]=r(" 導出 ",-1))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(Ce,{gutter:24,class:"stats-row"},{default:t(()=>[e(x,{span:6},{default:t(()=>[e(S,{class:"stat-card"},{default:t(()=>[o("div",Va,[o("div",wa,y(f.totalUsers),1),a[19]||(a[19]=o("div",{class:"stat-label"},"總用戶數",-1))]),o("div",Ea,[e(c,null,{default:t(()=>[e(d(G))]),_:1})])]),_:1})]),_:1}),e(x,{span:6},{default:t(()=>[e(S,{class:"stat-card"},{default:t(()=>[o("div",Ca,[o("div",Ua,y(f.activeUsers),1),a[20]||(a[20]=o("div",{class:"stat-label"},"活躍用戶",-1))]),o("div",Da,[e(c,null,{default:t(()=>[e(d(la))]),_:1})])]),_:1})]),_:1}),e(x,{span:6},{default:t(()=>[e(S,{class:"stat-card"},{default:t(()=>[o("div",ka,[o("div",ha,y(f.kycApprovedUsers),1),a[21]||(a[21]=o("div",{class:"stat-label"},"KYC通過",-1))]),o("div",Sa,[e(c,null,{default:t(()=>[e(d(sa))]),_:1})])]),_:1})]),_:1}),e(x,{span:6},{default:t(()=>[e(S,{class:"stat-card"},{default:t(()=>[o("div",Ia,[o("div",Aa,y(f.newUsersToday),1),a[22]||(a[22]=o("div",{class:"stat-label"},"今日新增",-1))]),o("div",Ta,[e(c,null,{default:t(()=>[e(d(J))]),_:1})])]),_:1})]),_:1})]),_:1}),e(S,{class:"table-card",shadow:"never"},{header:t(()=>[o("div",Pa,[a[24]||(a[24]=o("h3",null,"用戶列表",-1)),o("div",Na,[e(U,{type:"primary",onClick:ve},{default:t(()=>[e(c,null,{default:t(()=>[e(d(J))]),_:1}),a[23]||(a[23]=r(" 新增用戶 ",-1))]),_:1})])])]),default:t(()=>[Oe((A(),T(he,{data:N.value,"row-key":"id",onSelectionChange:de,onSortChange:ue},{default:t(()=>[e(D,{type:"selection",width:"50"}),e(D,{prop:"id",label:"用戶ID",width:"80",sortable:"custom"}),e(D,{label:"用戶信息","min-width":"200"},{default:t(({row:l})=>[o("div",Ya,[e(Ue,{size:40,src:l.avatar},{default:t(()=>[e(c,null,{default:t(()=>[e(d(G))]),_:1})]),_:2},1032,["src"]),o("div",xa,[o("div",La,y(l.username),1),o("div",za,y(l.email),1)])])]),_:1}),e(D,{label:"真實姓名",prop:"realName",width:"120"}),e(D,{label:"手機號碼",width:"140"},{default:t(({row:l})=>[o("div",Ma,[r(y(l.phone||"--")+" ",1),l.phoneVerified?(A(),T(R,{key:0,type:"success",size:"small"},{default:t(()=>[...a[25]||(a[25]=[r(" 已驗證 ",-1)])]),_:1})):q("",!0)])]),_:1}),e(D,{label:"狀態",width:"100",align:"center"},{default:t(({row:l})=>[e(R,{type:ae(l.status)},{default:t(()=>[r(y(te(l.status)),1)]),_:2},1032,["type"])]),_:1}),e(D,{label:"KYC狀態",width:"120",align:"center"},{default:t(({row:l})=>[e(R,{type:le(l.kycStatus)},{default:t(()=>[r(y(se(l.kycStatus)),1)]),_:2},1032,["type"])]),_:1}),e(D,{label:"註冊時間",width:"180",sortable:"custom"},{default:t(({row:l})=>[r(y(d(Z)(l.createdAt).format("YYYY-MM-DD HH:mm")),1)]),_:1}),e(D,{label:"最後登錄",width:"180"},{default:t(({row:l})=>[r(y(l.lastLoginAt?d(Z)(l.lastLoginAt).format("YYYY-MM-DD HH:mm"):"--"),1)]),_:1}),e(D,{label:"操作",width:"200",fixed:"right"},{default:t(({row:l})=>[e(U,{type:"primary",size:"small",onClick:K=>ie(l)},{default:t(()=>[...a[26]||(a[26]=[r(" 查看 ",-1)])]),_:2},1032,["onClick"]),e(ke,{onCommand:K=>ce(K,l)},{dropdown:t(()=>[e(De,null,{default:t(()=>[e(L,{command:"edit"},{default:t(()=>[e(c,null,{default:t(()=>[e(d(_a))]),_:1}),a[28]||(a[28]=r(" 編輯 ",-1))]),_:1}),e(L,{command:l.status==="ACTIVE"?"disable":"enable"},{default:t(()=>[e(c,null,{default:t(()=>[l.status==="ACTIVE"?(A(),T(d(W),{key:0})):(A(),T(d(X),{key:1}))]),_:2},1024),r(" "+y(l.status==="ACTIVE"?"禁用":"啟用"),1)]),_:2},1032,["command"]),e(L,{command:"resetPassword",divided:""},{default:t(()=>[e(c,null,{default:t(()=>[e(d(fa))]),_:1}),a[29]||(a[29]=r(" 重置密碼 ",-1))]),_:1}),e(L,{command:"delete",class:"danger-item"},{default:t(()=>[e(c,null,{default:t(()=>[e(d(Q))]),_:1}),a[30]||(a[30]=r(" 刪除 ",-1))]),_:1})]),_:2},1024)]),default:t(()=>[e(U,{size:"small"},{default:t(()=>[a[27]||(a[27]=r(" 更多 ",-1)),e(c,null,{default:t(()=>[e(d(ca))]),_:1})]),_:1})]),_:2},1032,["onCommand"])]),_:1})]),_:1},8,["data"])),[[Ae,u.value]]),o("div",Ba,[e(Se,{"current-page":_.currentPage,"onUpdate:currentPage":a[6]||(a[6]=l=>_.currentPage=l),"page-size":_.pageSize,"onUpdate:pageSize":a[7]||(a[7]=l=>_.pageSize=l),"page-sizes":[10,20,50,100],total:_.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:n,onCurrentChange:n},null,8,["current-page","page-size","total"])])]),_:1}),w.value.length>0?(A(),T(S,{key:0,class:"batch-actions",shadow:"never"},{default:t(()=>[o("div",Ra," 已選擇 "+y(w.value.length)+" 個用戶 ",1),o("div",Oa,[e(U,{type:"warning",onClick:ye},{default:t(()=>[e(c,null,{default:t(()=>[e(d(W))]),_:1}),a[31]||(a[31]=r(" 批量禁用 ",-1))]),_:1}),e(U,{onClick:Ve},{default:t(()=>[e(c,null,{default:t(()=>[e(d(X))]),_:1}),a[32]||(a[32]=r(" 批量啟用 ",-1))]),_:1}),e(U,{type:"danger",onClick:we},{default:t(()=>[e(c,null,{default:t(()=>[e(d(Q))]),_:1}),a[33]||(a[33]=r(" 批量刪除 ",-1))]),_:1})])]),_:1})):q("",!0),e(Ie,{modelValue:k.value,"onUpdate:modelValue":a[15]||(a[15]=l=>k.value=l),title:"新增用戶",width:"600px","close-on-click-modal":!1},{footer:t(()=>[e(U,{onClick:a[14]||(a[14]=l=>k.value=!1)},{default:t(()=>[...a[34]||(a[34]=[r("取消",-1)])]),_:1}),e(U,{type:"primary",onClick:ge,loading:M.value},{default:t(()=>[...a[35]||(a[35]=[r(" 創建 ",-1)])]),_:1},8,["loading"])]),default:t(()=>[e(O,{ref_key:"createUserFormRef",ref:Y,model:v,rules:ee,"label-width":"100px"},{default:t(()=>[e(g,{label:"用戶名",prop:"username"},{default:t(()=>[e(E,{modelValue:v.username,"onUpdate:modelValue":a[8]||(a[8]=l=>v.username=l)},null,8,["modelValue"])]),_:1}),e(g,{label:"郵箱",prop:"email"},{default:t(()=>[e(E,{modelValue:v.email,"onUpdate:modelValue":a[9]||(a[9]=l=>v.email=l)},null,8,["modelValue"])]),_:1}),e(g,{label:"密碼",prop:"password"},{default:t(()=>[e(E,{modelValue:v.password,"onUpdate:modelValue":a[10]||(a[10]=l=>v.password=l),type:"password","show-password":""},null,8,["modelValue"])]),_:1}),e(g,{label:"真實姓名",prop:"realName"},{default:t(()=>[e(E,{modelValue:v.realName,"onUpdate:modelValue":a[11]||(a[11]=l=>v.realName=l)},null,8,["modelValue"])]),_:1}),e(g,{label:"手機號碼",prop:"phone"},{default:t(()=>[e(E,{modelValue:v.phone,"onUpdate:modelValue":a[12]||(a[12]=l=>v.phone=l)},null,8,["modelValue"])]),_:1}),e(g,{label:"狀態",prop:"status"},{default:t(()=>[e(B,{modelValue:v.status,"onUpdate:modelValue":a[13]||(a[13]=l=>v.status=l)},{default:t(()=>[e(C,{label:"正常",value:"ACTIVE"}),e(C,{label:"禁用",value:"DISABLED"})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}}),rt=je(Ka,[["__scopeId","data-v-63b379b1"]]);export{rt as default};
