var tt=Object.defineProperty,st=Object.defineProperties;var lt=Object.getOwnPropertyDescriptors;var z=Object.getOwnPropertySymbols;var et=Object.prototype.hasOwnProperty,nt=Object.prototype.propertyIsEnumerable;var K=(c,a,i)=>a in c?tt(c,a,{enumerable:!0,configurable:!0,writable:!0,value:i}):c[a]=i,I=(c,a)=>{for(var i in a||(a={}))et.call(a,i)&&K(c,i,a[i]);if(z)for(var i of z(a))nt.call(a,i)&&K(c,i,a[i]);return c},j=(c,a)=>st(c,lt(a));var D=(c,a,i)=>new Promise((m,f)=>{var g=o=>{try{_(i.next(o))}catch(b){f(b)}},k=o=>{try{_(i.throw(o))}catch(b){f(b)}},_=o=>o.done?m(o.value):Promise.resolve(o.value).then(g,k);_((i=i.apply(c,a)).next())});import{k as ot,r as y,M as at,c as it,e as dt,l as d,m as u,q as t,C as p,B as w,am as E,an as ut,a6 as N,W as F,F as P,Y as q,K as Y}from"./vue-vendor-DL5bj91p.js";import{A as O}from"./admin-DGuZcCEp.js";import{a3 as e,s as M}from"./element-plus--BWWjcce.js";import{_ as rt}from"./index-CtT-RS4Y.js";const ct={class:"order-list-view"},vt={class:"filter-section"},pt={class:"filter-row"},mt={class:"filter-group"},bt={class:"filter-group"},yt={class:"filter-group"},_t={class:"filter-group"},ft={class:"filter-group"},gt={class:"table-section"},kt={class:"table-container"},Dt={class:"data-table"},Ct={class:"order-no"},ht={class:"order-id"},wt={class:"user-info"},Ot={class:"user-name"},St={class:"user-id"},xt={class:"user-email"},Tt={class:"amount-info"},Mt={class:"usdt-amount"},Ut={class:"total-amount"},At={class:"price"},It={class:"action-buttons"},Nt=["onClick"],$t=["onClick"],Vt=["onClick"],Lt={key:0,class:"loading-state"},Rt={key:1,class:"empty-state"},Wt={key:0,class:"pagination"},Bt=["disabled"],zt={class:"pagination-info"},Kt=["disabled"],jt={key:0,class:"modal-body"},Et={class:"detail-section"},Ft={class:"detail-grid"},Pt={class:"detail-item"},qt={class:"detail-item"},Yt={class:"detail-item"},Gt={class:"detail-item"},Ht={class:"detail-section"},Jt={class:"detail-grid"},Qt={class:"detail-item"},Xt={class:"detail-item"},Zt={class:"detail-item"},ts={class:"detail-item"},ss={class:"detail-section"},ls={class:"detail-grid"},es={class:"detail-item"},ns={class:"detail-item"},os={class:"detail-item"},as={key:0,class:"detail-section"},is={class:"detail-grid"},ds={class:"detail-item"},us={class:"detail-item"},rs={class:"detail-item"},cs={key:1,class:"detail-section"},vs={class:"modal-footer"},ps={class:"modal-body"},ms={class:"stats-grid"},bs={class:"stats-card"},ys={class:"stats-number"},_s={class:"stats-card"},fs={class:"stats-number"},gs={class:"stats-card"},ks={class:"stats-number"},Ds={class:"stats-card"},Cs={class:"stats-number"},hs={class:"stats-section"},ws={class:"status-stats"},Os={class:"status-label"},Ss={class:"status-count"},xs=ot({__name:"OrderListView",setup(c){const a=y(!1),i=y([]),m=y(1),f=y(20),g=y(0),k=y(!1),_=y(!1),o=y(null),b=y({totalOrders:0,totalAmount:0,todayOrders:0,completionRate:0,statusDistribution:{}}),r=at({status:"",type:"",userId:"",orderNo:"",createDate:""}),$=it(()=>Math.ceil(g.value/f.value)),v=()=>D(this,null,function*(){a.value=!0;try{const n=I({page:m.value,pageSize:f.value},r),s=yield O.getOrders(n);s.success&&(i.value=s.data.records||[],g.value=s.data.total||0)}catch(n){console.error("加载订单列表失败:",n)}finally{a.value=!1}}),G=()=>{Object.keys(r).forEach(n=>{r[n]=""}),m.value=1,v()},V=n=>{m.value=n,v()},H=n=>{o.value=n,k.value=!0},S=()=>{k.value=!1,o.value=null},L=n=>D(this,null,function*(){try{(yield O.confirmOrder(n.id)).success&&(alert("订单确认成功"),v(),k.value&&S())}catch(s){console.error("确认订单失败:",s),alert("确认订单失败")}}),J=n=>D(this,null,function*(){if(confirm("确定要取消这个订单吗？"))try{(yield O.cancelOrder(n.id)).success&&(alert("订单取消成功"),v())}catch(s){console.error("取消订单失败:",s),alert("取消订单失败")}}),Q=n=>["pending","paid"].includes(n.status),X=()=>D(this,null,function*(){try{const n=yield O.getOrderStats();n.success&&(b.value=n.data,_.value=!0)}catch(n){console.error("获取统计数据失败:",n)}}),U=()=>{_.value=!1},Z=()=>D(this,null,function*(){try{const n=j(I({},r),{export:!0}),s=yield O.exportOrders(n),T=new Blob([s.data],{type:"application/vnd.ms-excel"}),C=window.URL.createObjectURL(T),l=document.createElement("a");l.href=C,l.download=`orders_${new Date().getTime()}.xlsx`,l.click(),window.URL.revokeObjectURL(C)}catch(n){console.error("导出失败:",n)}}),x=n=>n?new Date(n).toLocaleString("zh-CN"):"-",R=n=>({buy:"买入",sell:"卖出"})[n]||n,A=n=>({pending:"待处理",paid:"已支付",completed:"已完成",cancelled:"已取消",expired:"已过期"})[n]||n;return dt(()=>{v()}),(n,s)=>{var T,C;return u(),d("div",ct,[s[47]||(s[47]=t("div",{class:"page-header"},[t("h1",null,"订单管理"),t("p",{class:"page-description"},"管理平台所有交易订单")],-1)),t("div",vt,[t("div",pt,[t("div",mt,[s[11]||(s[11]=t("label",null,"订单状态:",-1)),w(t("select",{"onUpdate:modelValue":s[0]||(s[0]=l=>r.status=l),onChange:v},[...s[10]||(s[10]=[ut('<option value="" data-v-dcc63610>全部</option><option value="pending" data-v-dcc63610>待处理</option><option value="paid" data-v-dcc63610>已支付</option><option value="completed" data-v-dcc63610>已完成</option><option value="cancelled" data-v-dcc63610>已取消</option><option value="expired" data-v-dcc63610>已过期</option>',6)])],544),[[E,r.status]])]),t("div",bt,[s[13]||(s[13]=t("label",null,"订单类型:",-1)),w(t("select",{"onUpdate:modelValue":s[1]||(s[1]=l=>r.type=l),onChange:v},[...s[12]||(s[12]=[t("option",{value:""},"全部",-1),t("option",{value:"buy"},"买入",-1),t("option",{value:"sell"},"卖出",-1)])],544),[[E,r.type]])]),t("div",yt,[s[14]||(s[14]=t("label",null,"用户ID:",-1)),w(t("input",{type:"text","onUpdate:modelValue":s[2]||(s[2]=l=>r.userId=l),onKeyup:F(v,["enter"]),placeholder:"输入用户ID"},null,544),[[N,r.userId]])]),t("div",_t,[s[15]||(s[15]=t("label",null,"订单号:",-1)),w(t("input",{type:"text","onUpdate:modelValue":s[3]||(s[3]=l=>r.orderNo=l),onKeyup:F(v,["enter"]),placeholder:"输入订单号"},null,544),[[N,r.orderNo]])]),t("div",ft,[s[16]||(s[16]=t("label",null,"创建时间:",-1)),w(t("input",{type:"date","onUpdate:modelValue":s[4]||(s[4]=l=>r.createDate=l),onChange:v},null,544),[[N,r.createDate]])]),t("button",{onClick:v,class:"btn btn-primary"},"搜索"),t("button",{onClick:G,class:"btn btn-secondary"},"重置")])]),t("div",gt,[t("div",{class:"table-header"},[s[17]||(s[17]=t("h3",null,"订单列表",-1)),t("div",{class:"table-actions"},[t("button",{onClick:Z,class:"btn btn-outline"},"导出订单"),t("button",{onClick:X,class:"btn btn-outline"},"统计分析")])]),t("div",kt,[t("table",Dt,[s[18]||(s[18]=t("thead",null,[t("tr",null,[t("th",null,"订单号"),t("th",null,"用户信息"),t("th",null,"订单类型"),t("th",null,"金额信息"),t("th",null,"价格"),t("th",null,"状态"),t("th",null,"创建时间"),t("th",null,"完成时间"),t("th",null,"操作")])],-1)),t("tbody",null,[(u(!0),d(P,null,q(i.value,l=>{var h,W;return u(),d("tr",{key:l.id},[t("td",null,[t("div",Ct,e(l.orderNo),1),t("div",ht,"ID: "+e(l.id),1)]),t("td",null,[t("div",wt,[t("div",Ot,e((h=l.user)==null?void 0:h.username),1),t("div",St,"ID: "+e(l.userId),1),t("div",xt,e((W=l.user)==null?void 0:W.email),1)])]),t("td",null,[t("span",{class:M(["order-type",`type-${l.type}`])},e(R(l.type)),3)]),t("td",null,[t("div",Tt,[t("div",Mt,e(l.amount)+" USDT",1),t("div",Ut,e(l.totalAmount)+" TWD",1)])]),t("td",null,[t("div",At,e(l.price)+" TWD/USDT",1)]),t("td",null,[t("span",{class:M(["status-badge",`status-${l.status}`])},e(A(l.status)),3)]),t("td",null,e(x(l.createdAt)),1),t("td",null,e(x(l.completedAt)),1),t("td",null,[t("div",It,[t("button",{onClick:B=>H(l),class:"btn btn-sm btn-primary"}," 详情 ",8,Nt),l.status==="paid"?(u(),d("button",{key:0,onClick:B=>L(l),class:"btn btn-sm btn-success"}," 确认完成 ",8,$t)):p("",!0),Q(l)?(u(),d("button",{key:1,onClick:B=>J(l),class:"btn btn-sm btn-danger"}," 取消订单 ",8,Vt)):p("",!0)])])])}),128))])]),a.value?(u(),d("div",Lt,[...s[19]||(s[19]=[t("div",{class:"loading-spinner"},null,-1),t("p",null,"加载中...",-1)])])):p("",!0),!a.value&&i.value.length===0?(u(),d("div",Rt,[...s[20]||(s[20]=[t("p",null,"暂无订单记录",-1)])])):p("",!0)]),g.value>f.value?(u(),d("div",Wt,[t("button",{onClick:s[5]||(s[5]=l=>V(m.value-1)),disabled:m.value<=1,class:"btn btn-outline btn-sm"}," 上一页 ",8,Bt),t("span",zt," 第 "+e(m.value)+" 页，共 "+e($.value)+" 页，总计 "+e(g.value)+" 条记录 ",1),t("button",{onClick:s[6]||(s[6]=l=>V(m.value+1)),disabled:m.value>=$.value,class:"btn btn-outline btn-sm"}," 下一页 ",8,Kt)])):p("",!0)]),k.value?(u(),d("div",{key:0,class:"modal-overlay",onClick:S},[t("div",{class:"modal-content",onClick:s[8]||(s[8]=Y(()=>{},["stop"]))},[t("div",{class:"modal-header"},[s[21]||(s[21]=t("h3",null,"订单详情",-1)),t("button",{onClick:S,class:"btn-close"},"×")]),o.value?(u(),d("div",jt,[t("div",Et,[s[26]||(s[26]=t("h4",null,"基本信息",-1)),t("div",Ft,[t("div",Pt,[s[22]||(s[22]=t("label",null,"订单号:",-1)),t("span",null,e(o.value.orderNo),1)]),t("div",qt,[s[23]||(s[23]=t("label",null,"订单类型:",-1)),t("span",{class:M(["order-type",`type-${o.value.type}`])},e(R(o.value.type)),3)]),t("div",Yt,[s[24]||(s[24]=t("label",null,"订单状态:",-1)),t("span",{class:M(["status-badge",`status-${o.value.status}`])},e(A(o.value.status)),3)]),t("div",Gt,[s[25]||(s[25]=t("label",null,"创建时间:",-1)),t("span",null,e(x(o.value.createdAt)),1)])])]),t("div",Ht,[s[31]||(s[31]=t("h4",null,"交易信息",-1)),t("div",Jt,[t("div",Qt,[s[27]||(s[27]=t("label",null,"USDT数量:",-1)),t("span",null,e(o.value.amount)+" USDT",1)]),t("div",Xt,[s[28]||(s[28]=t("label",null,"单价:",-1)),t("span",null,e(o.value.price)+" TWD/USDT",1)]),t("div",Zt,[s[29]||(s[29]=t("label",null,"总金额:",-1)),t("span",null,e(o.value.totalAmount)+" TWD",1)]),t("div",ts,[s[30]||(s[30]=t("label",null,"已成交数量:",-1)),t("span",null,e(o.value.filledAmount||0)+" USDT",1)])])]),t("div",ss,[s[35]||(s[35]=t("h4",null,"用户信息",-1)),t("div",ls,[t("div",es,[s[32]||(s[32]=t("label",null,"用户ID:",-1)),t("span",null,e(o.value.userId),1)]),t("div",ns,[s[33]||(s[33]=t("label",null,"用户名:",-1)),t("span",null,e((T=o.value.user)==null?void 0:T.username),1)]),t("div",os,[s[34]||(s[34]=t("label",null,"邮箱:",-1)),t("span",null,e((C=o.value.user)==null?void 0:C.email),1)])])]),o.value.paymentInfo?(u(),d("div",as,[s[39]||(s[39]=t("h4",null,"支付信息",-1)),t("div",is,[t("div",ds,[s[36]||(s[36]=t("label",null,"支付方式:",-1)),t("span",null,e(o.value.paymentMethod),1)]),t("div",us,[s[37]||(s[37]=t("label",null,"银行账户:",-1)),t("span",null,e(o.value.bankAccount),1)]),t("div",rs,[s[38]||(s[38]=t("label",null,"支付截止时间:",-1)),t("span",null,e(x(o.value.paymentDeadline)),1)])])])):p("",!0),o.value.adminNote?(u(),d("div",cs,[s[40]||(s[40]=t("h4",null,"管理员备注",-1)),t("p",null,e(o.value.adminNote),1)])):p("",!0)])):p("",!0),t("div",vs,[t("button",{onClick:S,class:"btn btn-secondary"},"关闭"),o.value&&o.value.status==="paid"?(u(),d("button",{key:0,onClick:s[7]||(s[7]=l=>L(o.value)),class:"btn btn-success"}," 确认完成 ")):p("",!0)])])])):p("",!0),_.value?(u(),d("div",{key:1,class:"modal-overlay",onClick:U},[t("div",{class:"modal-content",onClick:s[9]||(s[9]=Y(()=>{},["stop"]))},[t("div",{class:"modal-header"},[s[41]||(s[41]=t("h3",null,"订单统计分析",-1)),t("button",{onClick:U,class:"btn-close"},"×")]),t("div",ps,[t("div",ms,[t("div",bs,[s[42]||(s[42]=t("h4",null,"订单总数",-1)),t("div",ys,e(b.value.totalOrders),1)]),t("div",_s,[s[43]||(s[43]=t("h4",null,"交易总额",-1)),t("div",fs,e(b.value.totalAmount)+" TWD",1)]),t("div",gs,[s[44]||(s[44]=t("h4",null,"今日新增",-1)),t("div",ks,e(b.value.todayOrders),1)]),t("div",Ds,[s[45]||(s[45]=t("h4",null,"完成率",-1)),t("div",Cs,e(b.value.completionRate)+"%",1)])]),t("div",hs,[s[46]||(s[46]=t("h4",null,"状态分布",-1)),t("div",ws,[(u(!0),d(P,null,q(b.value.statusDistribution,(l,h)=>(u(),d("div",{key:h,class:"status-item"},[t("span",Os,e(A(h))+":",1),t("span",Ss,e(l),1)]))),128))])])]),t("div",{class:"modal-footer"},[t("button",{onClick:U,class:"btn btn-secondary"},"关闭")])])])):p("",!0)])}}}),Ns=rt(xs,[["__scopeId","data-v-dcc63610"]]);export{Ns as default};
