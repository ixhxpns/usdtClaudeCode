var k=(_,p,a)=>new Promise((i,u)=>{var n=t=>{try{m(a.next(t))}catch(e){u(e)}},x=t=>{try{m(a.throw(t))}catch(e){u(e)}},m=t=>t.done?i(t.value):Promise.resolve(t.value).then(n,x);m((a=a.apply(_,p)).next())});import{A as C}from"./AuthLayout-BYquXUgD.js";import{c as A,f as j,g as z,m as w,j as F,h as I,E}from"./element-plus-BimyLctg.js";import{d as L,r as g,_ as M,an as N,G as P,j as c,H as o,f as V,Q as s,k as l,u as f,Y as R,M as r,O as h}from"./vue-vendor-D1tpuXMX.js";import{u as q}from"./index-CNq4hTTw.js";import{V as D}from"./common-DZADQMio.js";import"./vendor-CPjYCZhe.js";const G={class:"text-sm text-gray-600 dark:text-gray-400"},H={key:0,class:"space-y-6"},O={class:"text-center"},Q={key:1,class:"text-center space-y-6"},T={class:"w-16 h-16 mx-auto bg-green-100 rounded-full flex items-center justify-center"},U={class:"text-sm text-gray-600 dark:text-gray-400"},Y={class:"font-medium"},$={class:"space-y-3"},oe=L({__name:"ForgotPasswordView",setup(_){const p=q(),a=g(),i=g(!1),u=g(!1),n=M({email:""}),x={email:[{required:!0,message:"请输入邮箱地址",trigger:"blur"},{validator:(t,e,d)=>{e&&!D.isEmail(e)?d(new Error("请输入有效的邮箱地址")):d()},trigger:"blur"}]},m=()=>k(this,null,function*(){if(a.value)try{yield a.value.validate(),i.value=!0,yield p.resetPassword(n.email),u.value=!0,E.success("重置密码邮件发送成功")}catch(t){console.error("重置密码失败:",t),E.error("发送失败，请稍后重试")}finally{i.value=!1}});return(t,e)=>{const d=N("router-link"),S=z,y=j,v=F,B=C;return c(),P(B,{"form-title":"忘记密码","form-subtitle":"请输入您的邮箱地址，我们将发送重置密码的链接",loading:t.isLoading,"loading-text":"发送中，请稍候..."},{navigation:o(()=>[l("p",G,[e[3]||(e[3]=r(" 记起密码了？ ",-1)),s(d,{to:"/login",class:"font-medium text-blue-600 hover:text-blue-500 dark:text-blue-400 transition-colors"},{default:o(()=>[...e[2]||(e[2]=[r(" 返回登录 ",-1)])]),_:1})])]),default:o(()=>[u.value?(c(),V("div",Q,[l("div",T,[s(f(I),{class:"text-2xl text-green-600"},{default:o(()=>[s(f(w))]),_:1})]),l("div",null,[e[9]||(e[9]=l("h3",{class:"text-lg font-medium text-gray-900 dark:text-white mb-2"}," 邮件已发送 ",-1)),l("p",U,[e[7]||(e[7]=r(" 我们已向 ",-1)),l("span",Y,h(n.email),1),e[8]||(e[8]=r(" 发送了重置密码的链接，请查收邮件并按照提示操作。 ",-1))])]),l("div",$,[s(v,{type:"primary",size:"large",class:"w-full",onClick:e[1]||(e[1]=b=>u.value=!1)},{default:o(()=>[...e[10]||(e[10]=[r(" 重新发送 ",-1)])]),_:1}),s(d,{to:"/login",class:"block text-sm font-medium text-blue-600 hover:text-blue-500 dark:text-blue-400"},{default:o(()=>[...e[11]||(e[11]=[r(" 返回登录 ",-1)])]),_:1})])])):(c(),V("div",H,[s(f(A),{ref_key:"formRef",ref:a,model:n,rules:x,onSubmit:R(m,["prevent"])},{default:o(()=>[s(y,{prop:"email"},{default:o(()=>[e[4]||(e[4]=l("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," 邮箱地址 ",-1)),s(S,{modelValue:n.email,"onUpdate:modelValue":e[0]||(e[0]=b=>n.email=b),type:"email",size:"large",placeholder:"请输入注册时的邮箱地址","prefix-icon":f(w),disabled:i.value},null,8,["modelValue","prefix-icon","disabled"])]),_:1}),s(y,null,{default:o(()=>[s(v,{type:"primary",size:"large",class:"w-full",loading:i.value,onClick:m},{default:o(()=>[...e[5]||(e[5]=[r(" 发送重置链接 ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"]),l("div",O,[s(d,{to:"/login",class:"text-sm font-medium text-blue-600 hover:text-blue-500 dark:text-blue-400"},{default:o(()=>[...e[6]||(e[6]=[r(" 返回登录 ",-1)])]),_:1})])]))]),_:1},8,["loading"])}}});export{oe as default};
