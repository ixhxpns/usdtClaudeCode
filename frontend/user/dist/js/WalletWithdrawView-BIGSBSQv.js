var ze=Object.defineProperty,Me=Object.defineProperties;var Pe=Object.getOwnPropertyDescriptors;var se=Object.getOwnPropertySymbols;var Le=Object.prototype.hasOwnProperty,qe=Object.prototype.propertyIsEnumerable;var le=(_,m,c)=>m in _?ze(_,m,{enumerable:!0,configurable:!0,writable:!0,value:c}):_[m]=c,oe=(_,m)=>{for(var c in m||(m={}))Le.call(m,c)&&le(_,c,m[c]);if(se)for(var c of se(m))qe.call(m,c)&&le(_,c,m[c]);return _},ne=(_,m)=>Me(_,Pe(m));var V=(_,m,c)=>new Promise((W,B)=>{var F=f=>{try{w(c.next(f))}catch($){B($)}},T=f=>{try{w(c.throw(f))}catch($){B($)}},w=f=>f.done?W(f.value):Promise.resolve(f.value).then(F,T);w((c=c.apply(_,m)).next())});import{j as Re,k as Ie,h as Ke,ah as He,x as Oe,c as Ge,f as Qe,d as Ye,e as Ze,Z as Je,_ as Xe,g as et,i as tt,af as at,an as st,a3 as lt,a4 as ot,S as nt,a5 as rt,ae as dt,v as it,E as x,a1 as ut}from"./element-plus-BimyLctg.js";import{d as ct,aQ as mt,r as p,_ as pt,c as E,o as ft,f as y,j as d,k as o,Q as n,H as l,M as u,O as r,u as _t,K as h,G as b,P as z,aj as M,I as vt}from"./vue-vendor-D1tpuXMX.js";import{g as yt,d as gt,s as bt,e as wt,f as kt}from"./wallet-Bpk4c6bO.js";import{g as xt}from"./kyc-C9ZWcgtY.js";import{_ as ht}from"./index-CNq4hTTw.js";import"./vendor-CPjYCZhe.js";const Ct={class:"wallet-withdraw-view"},Vt={key:0,class:"mt-6"},Et={class:"mt-3"},Wt={key:1},Bt={class:"mt-6"},Tt={class:"flex items-center justify-between"},$t={class:"text-3xl font-bold text-gray-900 dark:text-white"},At={class:"text-sm text-gray-500 mt-1"},Ft={class:"balance-icon"},Nt={class:"mt-6"},Ut={class:"flex items-center space-x-2"},jt=["src","alt"],St={class:"flex items-center justify-between"},Dt={class:"text-sm text-gray-500"},zt={class:"flex items-center justify-between"},Mt={class:"text-sm text-gray-500"},Pt={class:"mt-2"},Lt={class:"mt-2"},qt={class:"mt-2 flex items-center justify-between"},Rt={class:"text-sm text-gray-500"},It={key:0},Kt={class:"space-x-2"},Ht={class:"mt-2"},Ot={class:"flex items-center space-x-3"},Gt={key:0,class:"mt-6"},Qt={class:"space-y-3"},Yt={class:"flex justify-between"},Zt={class:"font-medium"},Jt={class:"flex justify-between"},Xt={class:"font-medium"},ea={class:"flex justify-between"},ta={class:"font-medium"},aa={class:"flex justify-between text-lg font-semibold"},sa={class:"text-sm text-gray-500"},la={class:"mt-6 flex justify-end space-x-3"},oa={class:"mt-6"},na={class:"flex items-center justify-between"},ra={key:0},da={key:1},ia={key:2},ua={class:"font-mono text-sm"},ca=ct({__name:"WalletWithdrawView",setup(_){const m=mt(),c=p(),W=p(!1),B=p(!1),F=p(!1),T=p(!1),w=p(0),f=p(!1),$=p(!0),A=p(0),I=p(0),a=pt({method:"crypto",currency:"USDT",network:"",address:"",addressLabel:"",bankCard:"",amount:"",fundPassword:"",verificationCode:""}),re=p([{id:"crypto",name:"加密货币",icon:"/images/crypto-icon.png",enabled:!0},{id:"bank",name:"银行转账",icon:"/images/bank-icon.png",enabled:!0}]),K=p([{code:"USDT",name:"Tether",balance:0,minWithdraw:10,maxWithdraw:1e5},{code:"BTC",name:"Bitcoin",balance:0,minWithdraw:.001,maxWithdraw:10},{code:"ETH",name:"Ethereum",balance:0,minWithdraw:.01,maxWithdraw:100}]),H=p([{id:"trc20",name:"TRC20 (Tron)",fee:1},{id:"erc20",name:"ERC20 (Ethereum)",fee:15},{id:"bep20",name:"BEP20 (BSC)",fee:.8}]),de=p([{id:"1",bankName:"中国银行",cardNumber:"1234567890123456"}]),P=p([]),L=p([]),ie={method:[{required:!0,message:"请选择提现方式",trigger:"change"}],currency:[{required:!0,message:"请选择币种",trigger:"change"}],network:[{required:!0,message:"请选择网络",trigger:"change"}],address:[{required:!0,message:"请输入提现地址",trigger:"blur"},{min:20,message:"请输入有效的地址",trigger:"blur"}],bankCard:[{required:!0,message:"请选择银行卡",trigger:"change"}],amount:[{required:!0,message:"请输入提现金额",trigger:"blur"},{pattern:/^\d+(\.\d{1,8})?$/,message:"请输入有效的金额",trigger:"blur"}],fundPassword:[{required:!0,message:"请输入资金密码",trigger:"blur"},{min:6,max:20,message:"资金密码长度在 6 到 20 个字符",trigger:"blur"}],verificationCode:[{required:!0,message:"请输入验证码",trigger:"blur"},{pattern:/^\d{6}$/,message:"请输入6位数字验证码",trigger:"blur"}]},C=E(()=>K.value.find(s=>s.code===a.currency)),O=E(()=>H.value.find(s=>s.id===a.network)),G=E(()=>a.amount?a.method==="crypto"&&O.value?O.value.fee:a.method==="bank"?parseFloat(a.amount)*.001:0:0),Q=E(()=>a.amount?parseFloat(a.amount)*.002:0),ue=E(()=>a.amount?parseFloat(a.amount)-G.value-Q.value:0),ce=E(()=>a.method==="crypto"?"10-30分钟":"1-3个工作日"),me=E(()=>{if(!a.currency||!a.amount||!a.fundPassword||!a.verificationCode)return!1;const s=parseFloat(a.amount),e=C.value;return!(!e||s<e.minWithdraw||s>Math.min(e.maxWithdraw,A.value)||a.method==="crypto"&&(!a.network||!a.address)||a.method==="bank"&&!a.bankCard)}),Y=()=>V(this,null,function*(){try{const s=yield yt();s.data.success&&(A.value=s.data.data.balance,I.value=s.data.data.frozen)}catch(s){console.error("获取钱包余额失败:",s)}}),Z=()=>V(this,null,function*(){try{T.value=!0;const s=yield gt({limit:5});s.data.success&&(L.value=s.data.data.records)}catch(s){console.error("获取提现记录失败:",s)}finally{T.value=!1}}),pe=()=>V(this,null,function*(){try{const s=yield kt();s.data.success&&(P.value=s.data.data)}catch(s){console.error("获取地址簿失败:",s)}}),fe=()=>{a.network="",a.address=""},j=s=>{var i;const e=Math.min(((i=C.value)==null?void 0:i.maxWithdraw)||999999999,A.value);a.amount=(e*s).toFixed(8)},_e=()=>V(this,null,function*(){try{F.value=!0;const s=yield bt();s.data.success?(x.success("验证码已发送"),ve()):x.error(s.data.message||"发送验证码失败")}catch(s){console.error("发送验证码失败:",s),x.error("发送验证码失败，请重试")}finally{F.value=!1}}),ve=()=>{w.value=60;const s=setInterval(()=>{w.value--,w.value<=0&&clearInterval(s)},1e3)},ye=()=>V(this,null,function*(){try{if(!(yield c.value.validate())||!(yield ut.confirm(`确认提现 ${a.amount} ${a.currency} 吗？`,"确认提现",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"})))return;B.value=!0;const i=yield wt(ne(oe({},a),{amount:parseFloat(a.amount),saveToAddressBook:f.value}));i.data.success?(x.success("提现申请已提交"),J(),Z(),Y()):x.error(i.data.message||"提现申请失败")}catch(s){s!=="cancel"&&(console.error("提现申请失败:",s),x.error("提现申请失败，请重试"))}finally{B.value=!1}}),J=()=>{Object.assign(a,{method:"crypto",currency:"USDT",network:"",address:"",addressLabel:"",bankCard:"",amount:"",fundPassword:"",verificationCode:""}),f.value=!1},ge=()=>{pe(),W.value=!0},be=s=>{a.address=s.address,a.network=s.network,W.value=!1},we=()=>{x.info("添加银行卡功能开发中")},ke=()=>{x.info("忘记密码功能开发中")},xe=()=>{m.push("/kyc/status")},he=()=>{m.push("/wallet/transactions?type=withdraw")},Ce=s=>{x.info(`查看提现详情: ${s}`)},g=(s,e="USDT")=>{const i=typeof s=="string"?parseFloat(s):s;return isNaN(i)?"0":`${i.toLocaleString()} ${e}`},Ve=s=>new Date(s).toLocaleString("zh-CN"),Ee=s=>({crypto:"加密货币",bank:"银行转账"})[s]||s,We=s=>({pending:"待处理",processing:"处理中",completed:"已完成",failed:"失败",cancelled:"已取消"})[s]||s,Be=s=>({pending:"warning",processing:"info",completed:"success",failed:"danger",cancelled:"info"})[s]||"info";return ft(()=>V(this,null,function*(){var s;yield Y(),yield Z();try{const e=yield xt();e.data.success&&($.value=((s=e.data.data)==null?void 0:s.status)==="approved")}catch(e){console.error("获取KYC状态失败:",e)}})),(s,e)=>{const i=Re,X=Ie,Te=Ke,S=Oe,$e=Ze,Ae=Ye,k=Qe,q=Xe,R=Je,N=et,Fe=tt,ee=at,Ne=Ge,Ue=st,v=ot,je=nt,te=lt,ae=dt,Se=it,De=rt;return d(),y("div",Ct,[e[39]||(e[39]=o("div",{class:"page-header"},[o("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"},"钱包提现"),o("p",{class:"mt-1 text-sm text-gray-600 dark:text-gray-400"}," 将您的资产提现到外部钱包或银行账户 ")],-1)),$.value?(d(),y("div",Wt,[o("div",Bt,[n(S,{class:"balance-card"},{default:l(()=>[o("div",Tt,[o("div",null,[e[16]||(e[16]=o("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"可提现余额",-1)),o("p",$t,r(g(A.value)),1),o("p",At," 冻结资金: "+r(g(I.value)),1)]),o("div",Ft,[n(Te,{size:40,class:"text-green-500"},{default:l(()=>[n(_t(He))]),_:1})])])]),_:1})]),o("div",Nt,[n(S,null,{header:l(()=>[...e[17]||(e[17]=[o("span",{class:"text-lg font-medium"},"提现信息",-1)])]),default:l(()=>[n(Ne,{ref_key:"formRef",ref:c,model:a,rules:ie,"label-width":"120px",size:"large"},{default:l(()=>[n(k,{label:"提现方式",prop:"method"},{default:l(()=>[n(Ae,{modelValue:a.method,"onUpdate:modelValue":e[0]||(e[0]=t=>a.method=t),size:"large"},{default:l(()=>[(d(!0),y(z,null,M(re.value,t=>(d(),b($e,{key:t.id,label:t.id,disabled:!t.enabled},{default:l(()=>[o("div",Ut,[o("img",{src:t.icon,alt:t.name,class:"w-6 h-6"},null,8,jt),o("span",null,r(t.name),1)])]),_:2},1032,["label","disabled"]))),128))]),_:1},8,["modelValue"])]),_:1}),n(k,{label:"币种",prop:"currency"},{default:l(()=>[n(R,{modelValue:a.currency,"onUpdate:modelValue":e[1]||(e[1]=t=>a.currency=t),placeholder:"请选择币种",onChange:fe},{default:l(()=>[(d(!0),y(z,null,M(K.value,t=>(d(),b(q,{key:t.code,label:`${t.name} (${t.code})`,value:t.code},{default:l(()=>[o("div",St,[o("span",null,r(t.name)+" ("+r(t.code)+")",1),o("span",Dt," 余额: "+r(g(t.balance,t.code)),1)])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a.method==="crypto"?(d(),b(k,{key:0,label:"网络",prop:"network"},{default:l(()=>[n(R,{modelValue:a.network,"onUpdate:modelValue":e[2]||(e[2]=t=>a.network=t),placeholder:"请选择网络"},{default:l(()=>[(d(!0),y(z,null,M(H.value,t=>(d(),b(q,{key:t.id,label:t.name,value:t.id},{default:l(()=>[o("div",zt,[o("span",null,r(t.name),1),o("span",Mt," 手续费: "+r(t.fee)+" "+r(a.currency),1)])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):h("",!0),a.method==="crypto"?(d(),b(k,{key:1,label:"提现地址",prop:"address"},{default:l(()=>[n(N,{modelValue:a.address,"onUpdate:modelValue":e[3]||(e[3]=t=>a.address=t),placeholder:"请输入钱包地址",clearable:""},{append:l(()=>[n(i,{onClick:ge},{default:l(()=>[...e[18]||(e[18]=[u(" 地址簿 ",-1)])]),_:1})]),_:1},8,["modelValue"]),o("div",Pt,[n(Fe,{modelValue:f.value,"onUpdate:modelValue":e[4]||(e[4]=t=>f.value=t)},{default:l(()=>[...e[19]||(e[19]=[u(" 保存到地址簿 ",-1)])]),_:1},8,["modelValue"])])]),_:1})):h("",!0),a.method==="bank"?(d(),b(k,{key:2,label:"银行卡",prop:"bankCard"},{default:l(()=>[n(R,{modelValue:a.bankCard,"onUpdate:modelValue":e[5]||(e[5]=t=>a.bankCard=t),placeholder:"请选择银行卡"},{default:l(()=>[(d(!0),y(z,null,M(de.value,t=>(d(),b(q,{key:t.id,label:`${t.bankName} (*${t.cardNumber.slice(-4)})`,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),o("div",Lt,[n(ee,{type:"primary",onClick:we},{default:l(()=>[...e[20]||(e[20]=[u(" + 添加新银行卡 ",-1)])]),_:1})])]),_:1})):h("",!0),n(k,{label:"提现金额",prop:"amount"},{default:l(()=>{var t,D;return[n(N,{modelValue:a.amount,"onUpdate:modelValue":e[6]||(e[6]=U=>a.amount=U),placeholder:"请输入提现金额",type:"number",min:((t=C.value)==null?void 0:t.minWithdraw)||0,max:Math.min(((D=C.value)==null?void 0:D.maxWithdraw)||999999999,A.value)},{append:l(()=>[u(r(a.currency),1)]),_:1},8,["modelValue","min","max"]),o("div",qt,[o("div",Rt,[C.value?(d(),y("p",It," 最小提现: "+r(g(C.value.minWithdraw,a.currency))+" | 最大提现: "+r(g(Math.min(C.value.maxWithdraw,A.value),a.currency)),1)):h("",!0)]),o("div",Kt,[n(i,{size:"small",onClick:e[7]||(e[7]=U=>j(.25)),text:""},{default:l(()=>[...e[21]||(e[21]=[u(" 25% ",-1)])]),_:1}),n(i,{size:"small",onClick:e[8]||(e[8]=U=>j(.5)),text:""},{default:l(()=>[...e[22]||(e[22]=[u(" 50% ",-1)])]),_:1}),n(i,{size:"small",onClick:e[9]||(e[9]=U=>j(.75)),text:""},{default:l(()=>[...e[23]||(e[23]=[u(" 75% ",-1)])]),_:1}),n(i,{size:"small",onClick:e[10]||(e[10]=U=>j(1)),text:""},{default:l(()=>[...e[24]||(e[24]=[u(" 全部 ",-1)])]),_:1})])])]}),_:1}),a.method==="crypto"&&f.value?(d(),b(k,{key:3,label:"地址标签"},{default:l(()=>[n(N,{modelValue:a.addressLabel,"onUpdate:modelValue":e[11]||(e[11]=t=>a.addressLabel=t),placeholder:"为此地址添加标签（可选）",maxlength:"50","show-word-limit":""},null,8,["modelValue"])]),_:1})):h("",!0),n(k,{label:"资金密码",prop:"fundPassword"},{default:l(()=>[n(N,{modelValue:a.fundPassword,"onUpdate:modelValue":e[12]||(e[12]=t=>a.fundPassword=t),type:"password",placeholder:"请输入资金密码","show-password":"",maxlength:"20"},null,8,["modelValue"]),o("div",Ht,[n(ee,{type:"primary",onClick:ke},{default:l(()=>[...e[25]||(e[25]=[u(" 忘记资金密码？ ",-1)])]),_:1})])]),_:1}),n(k,{label:"验证码",prop:"verificationCode"},{default:l(()=>[o("div",Ot,[n(N,{modelValue:a.verificationCode,"onUpdate:modelValue":e[13]||(e[13]=t=>a.verificationCode=t),placeholder:"请输入验证码",maxlength:"6",class:"flex-1"},null,8,["modelValue"]),n(i,{onClick:_e,loading:F.value,disabled:w.value>0},{default:l(()=>[u(r(w.value>0?`${w.value}s`:"发送验证码"),1)]),_:1},8,["loading","disabled"])])]),_:1})]),_:1},8,["model"]),a.amount?(d(),y("div",Gt,[n(S,{class:"fee-summary"},{header:l(()=>[...e[26]||(e[26]=[o("span",{class:"font-medium"},"费用明细",-1)])]),default:l(()=>[o("div",Qt,[o("div",Yt,[e[27]||(e[27]=o("span",null,"提现金额",-1)),o("span",Zt,r(g(a.amount,a.currency)),1)]),o("div",Jt,[e[28]||(e[28]=o("span",null,"网络手续费",-1)),o("span",Xt,r(g(G.value,a.currency)),1)]),o("div",ea,[e[29]||(e[29]=o("span",null,"平台手续费",-1)),o("span",ta,r(g(Q.value,a.currency)),1)]),n(Ue),o("div",aa,[e[30]||(e[30]=o("span",null,"实际到账",-1)),o("span",null,r(g(ue.value,a.currency)),1)]),o("div",sa," 预计到账时间: "+r(ce.value),1)])]),_:1})])):h("",!0),n(X,{type:"warning",closable:!1,class:"mt-6"},{title:l(()=>[...e[31]||(e[31]=[o("strong",null,"安全提醒",-1)])]),default:l(()=>[e[32]||(e[32]=o("ul",{class:"list-disc list-inside space-y-1 text-sm"},[o("li",null,"请仔细核对提现地址，转账后无法撤销"),o("li",null,"提现前请确认网络类型正确，避免资产丢失"),o("li",null,"大额提现可能需要人工审核，请耐心等待"),o("li",null,"如有疑问请及时联系客服")],-1))]),_:1}),o("div",la,[n(i,{onClick:J},{default:l(()=>[...e[33]||(e[33]=[u("重置",-1)])]),_:1}),n(i,{type:"primary",onClick:ye,loading:B.value,disabled:!me.value,size:"large"},{default:l(()=>[...e[34]||(e[34]=[u(" 确认提现 ",-1)])]),_:1},8,["loading","disabled"])])]),_:1})]),o("div",oa,[n(S,null,{header:l(()=>[o("div",na,[e[36]||(e[36]=o("span",{class:"text-lg font-medium"},"最近提现记录",-1)),n(i,{text:"",type:"primary",onClick:he},{default:l(()=>[...e[35]||(e[35]=[u(" 查看全部 ",-1)])]),_:1})])]),default:l(()=>[vt((d(),b(te,{data:L.value,style:{width:"100%"}},{default:l(()=>[n(v,{prop:"createdAt",label:"时间",width:"180"},{default:l(({row:t})=>[u(r(Ve(t.createdAt)),1)]),_:1}),n(v,{prop:"currency",label:"币种",width:"100"}),n(v,{prop:"amount",label:"金额",width:"120"},{default:l(({row:t})=>[u(r(g(t.amount,t.currency)),1)]),_:1}),n(v,{prop:"fee",label:"手续费",width:"100"},{default:l(({row:t})=>[u(r(g(t.fee,t.currency)),1)]),_:1}),n(v,{prop:"method",label:"方式",width:"100"},{default:l(({row:t})=>[u(r(Ee(t.method)),1)]),_:1}),n(v,{prop:"status",label:"状态",width:"100"},{default:l(({row:t})=>[n(je,{type:Be(t.status)},{default:l(()=>[u(r(We(t.status)),1)]),_:2},1032,["type"])]),_:1}),n(v,{prop:"address",label:"地址/账号","min-width":"200"},{default:l(({row:t})=>[t.address?(d(),y("span",ra,r(t.address.slice(0,10))+"..."+r(t.address.slice(-10)),1)):t.bankAccount?(d(),y("span",da,r(t.bankAccount),1)):(d(),y("span",ia,"-"))]),_:1}),n(v,{label:"操作",width:"100"},{default:l(({row:t})=>[n(i,{text:"",type:"primary",onClick:D=>Ce(t.id)},{default:l(()=>[...e[37]||(e[37]=[u(" 详情 ",-1)])]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[De,T.value]]),!T.value&&L.value.length===0?(d(),b(ae,{key:0,description:"暂无提现记录"})):h("",!0)]),_:1})])])):(d(),y("div",Vt,[n(X,{title:"需要完成KYC验证",description:"为了确保资金安全，提现功能需要完成身份验证",type:"warning",closable:!1,"show-icon":""},{default:l(()=>[o("div",Et,[n(i,{type:"primary",onClick:xe},{default:l(()=>[...e[15]||(e[15]=[u(" 立即认证 ",-1)])]),_:1})])]),_:1})])),n(Se,{modelValue:W.value,"onUpdate:modelValue":e[14]||(e[14]=t=>W.value=t),title:"地址簿",width:"600px",center:""},{default:l(()=>[n(te,{data:P.value,style:{width:"100%"}},{default:l(()=>[n(v,{prop:"label",label:"标签",width:"120"}),n(v,{prop:"address",label:"地址","min-width":"300"},{default:l(({row:t})=>[o("span",ua,r(t.address),1)]),_:1}),n(v,{prop:"network",label:"网络",width:"100"}),n(v,{label:"操作",width:"80"},{default:l(({row:t})=>[n(i,{text:"",type:"primary",onClick:D=>be(t)},{default:l(()=>[...e[38]||(e[38]=[u(" 选择 ",-1)])]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),P.value.length===0?(d(),b(ae,{key:0,description:"暂无保存的地址"})):h("",!0)]),_:1},8,["modelValue"])])}}}),ba=ht(ca,[["__scopeId","data-v-dc8485c6"]]);export{ba as default};
