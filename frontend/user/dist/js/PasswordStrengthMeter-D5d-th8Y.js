import{y as M,aa as $,h as S}from"./element-plus-BimyLctg.js";import{d as C,c as g,f as l,K as f,j as o,k as a,P as d,aj as p,J as i,O as u,Q as B,H as L,G as m,u as h}from"./vue-vendor-D1tpuXMX.js";import{_ as q}from"./index-CNq4hTTw.js";const P={key:0,class:"password-strength-meter mt-2"},z={class:"flex items-center space-x-1 mb-2"},A={class:"flex items-center justify-between mb-2"},N={class:"text-xs text-gray-500 dark:text-gray-400"},T={class:"space-y-1"},j={key:0,class:"mt-2"},E={class:"text-xs text-gray-500 dark:text-gray-400 space-y-0.5"},V=C({__name:"PasswordStrengthMeter",props:{password:{},minLength:{default:8},requireUppercase:{type:Boolean,default:!0},requireLowercase:{type:Boolean,default:!0},requireNumbers:{type:Boolean,default:!0},requireSpecialChars:{type:Boolean,default:!0}},setup(x){const t=x,n=g(()=>{if(!t.password)return{score:0,feedback:[],entropy:0,crackTime:""};let e=0;const r=[];t.password.length>=t.minLength?e+=1:r.push(`至少需要 ${t.minLength} 个字符`),/[A-Z]/.test(t.password)?e+=1:t.requireUppercase&&r.push("包含大写字母"),/[a-z]/.test(t.password)?e+=1:t.requireLowercase&&r.push("包含小写字母"),/\d/.test(t.password)?e+=1:t.requireNumbers&&r.push("包含数字"),/[!@#$%^&*(),.?":{}|<>]/.test(t.password)?e+=1:t.requireSpecialChars&&r.push("包含特殊字符 (!@#$%^&*等)"),t.password.length>=12&&(e+=.5),t.password.length>=16&&(e+=.5),/[!@#$%^&*()_+={}\[\]|\\:";'<>,.?/~`]/.test(t.password)&&(e+=.5),/(.)\1{2,}/.test(t.password)&&(e-=1,r.push("避免连续重复字符")),/123|abc|qwe/i.test(t.password)&&(e-=1,r.push("避免常见字符序列"));const c=_(t.password),s=v(c);return{score:Math.max(0,Math.min(5,Math.floor(e))),feedback:r,entropy:c,crackTime:s}}),y=g(()=>[{key:"length",label:`至少 ${t.minLength} 个字符`,met:t.password.length>=t.minLength},{key:"uppercase",label:"包含大写字母",met:/[A-Z]/.test(t.password)},{key:"lowercase",label:"包含小写字母",met:/[a-z]/.test(t.password)},{key:"numbers",label:"包含数字",met:/\d/.test(t.password)},{key:"special",label:"包含特殊字符",met:/[!@#$%^&*(),.?":{}|<>]/.test(t.password)}]),k=()=>["bg-red-400","bg-red-400","bg-orange-400","bg-yellow-400","bg-green-400","bg-green-500"][n.value.score]||"bg-gray-200",b=()=>["text-red-500","text-red-500","text-orange-500","text-yellow-500","text-green-500","text-green-600"][n.value.score]||"text-gray-500",w=()=>["很弱","弱","一般","较强","强","很强"][n.value.score]||"无",_=e=>{if(!e)return 0;let r=0;return/[a-z]/.test(e)&&(r+=26),/[A-Z]/.test(e)&&(r+=26),/\d/.test(e)&&(r+=10),/[!@#$%^&*(),.?":{}|<>]/.test(e)&&(r+=32),Math.log2(Math.pow(r,e.length))},v=e=>{if(e===0)return"立即";const s=Math.pow(2,e-1)/1e8;return s<60?"不到1分钟":s<3600?`${Math.ceil(s/60)}分钟`:s<86400?`${Math.ceil(s/3600)}小时`:s<31536e3?`${Math.ceil(s/86400)}天`:s<31536e5?`${Math.ceil(s/31536e3)}年`:"几个世纪"};return(e,r)=>{const c=S;return e.password?(o(),l("div",P,[a("div",z,[(o(),l(d,null,p(5,s=>a("div",{key:s,class:i(["flex-1 h-1.5 rounded transition-colors duration-200",s<=n.value.score?k():"bg-gray-200 dark:bg-gray-600"])},null,2)),64))]),a("div",A,[a("span",{class:i(["text-sm font-medium transition-colors duration-200",b()])},u(w()),3),a("span",N,u(n.value.score)+"/5 ",1)]),a("div",T,[(o(!0),l(d,null,p(y.value,s=>(o(),l("div",{key:s.key,class:"flex items-center space-x-2 text-xs"},[B(c,{size:12,class:i(s.met?"text-green-500":"text-gray-400")},{default:L(()=>[s.met?(o(),m(h(M),{key:0})):(o(),m(h($),{key:1}))]),_:2},1032,["class"]),a("span",{class:i(s.met?"text-green-600 dark:text-green-400":"text-gray-500 dark:text-gray-400")},u(s.label),3)]))),128))]),n.value.feedback.length>0?(o(),l("div",j,[r[1]||(r[1]=a("p",{class:"text-xs text-gray-600 dark:text-gray-400 mb-1"},"建议:",-1)),a("ul",E,[(o(!0),l(d,null,p(n.value.feedback,s=>(o(),l("li",{key:s,class:"flex items-start space-x-1"},[r[0]||(r[0]=a("span",{class:"inline-block w-1 h-1 bg-gray-400 rounded-full mt-1.5 flex-shrink-0"},null,-1)),a("span",null,u(s),1)]))),128))])])):f("",!0)])):f("",!0)}}}),D=q(V,[["__scopeId","data-v-956e4698"]]);export{D as P};
