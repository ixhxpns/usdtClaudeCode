import{j as F}from"./element-plus-BimyLctg.js";import{d as K,r as m,w as I,o as T,U,f as d,j as c,k as y,K as b,P as N,aj as P,O as k,G as L,H as z,M as G,n as H,I as J,aA as O,J as S}from"./vue-vendor-D1tpuXMX.js";import{_ as q}from"./index-CNq4hTTw.js";const Q={class:"verification-code-input"},W={class:"flex items-center justify-center space-x-2 mb-4"},X=["onUpdate:modelValue","disabled","onInput","onKeydown"],Y={key:0,class:"text-center"},Z={class:"text-sm text-red-500"},$={key:1,class:"text-center"},ee={key:0,class:"text-sm text-gray-500 dark:text-gray-400"},te={key:2,class:"text-center mt-2"},oe={class:"text-xs text-gray-500 dark:text-gray-400"},ae=K({__name:"VerificationCodeInput",props:{modelValue:{default:""},length:{default:6},disabled:{type:Boolean,default:!1},error:{default:""},showResend:{type:Boolean,default:!0},resendCountdown:{default:60},resending:{type:Boolean,default:!1},hint:{default:""},autoFocus:{type:Boolean,default:!0}},emits:["update:modelValue","complete","resend"],setup(V,{expose:B,emit:C}){const o=V,h=C,a=m(Array(o.length).fill("")),_=m([]),i=m(0),g=m(),x=(e,t)=>{_.value[t]=e},j=(e,t)=>{const n=t.target.value.replace(/[^0-9]/g,"");if(n.length>1){const l=n.split("").slice(0,o.length-e);l.forEach((v,p)=>{e+p<o.length&&(a.value[e+p]=v)});const r=Math.min(e+l.length,o.length-1);u(r)}else a.value[e]=n,n&&e<o.length-1&&u(e+1);f()},D=(e,t)=>{if(t.key==="Backspace")!a.value[e]&&e>0?(a.value[e-1]="",u(e-1)):a.value[e]="",f();else if(t.key==="ArrowLeft"&&e>0)u(e-1);else if(t.key==="ArrowRight"&&e<o.length-1)u(e+1);else if(t.key==="Enter"){const s=a.value.join("");s.length===o.length&&h("complete",s)}},E=e=>{var n;e.preventDefault();const s=(((n=e.clipboardData)==null?void 0:n.getData("text"))||"").replace(/[^0-9]/g,"").slice(0,o.length);if(s){const l=s.split("");l.forEach((v,p)=>{p<o.length&&(a.value[p]=v)});const r=Math.min(l.length-1,o.length-1);u(r),f()}},u=e=>{H(()=>{const t=_.value[e];t&&(t.focus(),t.select())})},f=()=>{const e=a.value.join("");h("update:modelValue",e),e.length===o.length&&h("complete",e)},M=()=>{h("resend"),R()},R=()=>{i.value=o.resendCountdown,g.value=setInterval(()=>{i.value--,i.value<=0&&clearInterval(g.value)},1e3)},A=()=>{a.value=Array(o.length).fill(""),f(),o.autoFocus&&u(0)},w=e=>{const t=e.slice(0,o.length).split("");t.forEach((s,n)=>{a.value[n]=s});for(let s=t.length;s<o.length;s++)a.value[s]="";f()};return I(()=>o.modelValue,e=>{e!==a.value.join("")&&w(e)},{immediate:!0}),I(()=>o.error,e=>{if(!e){const t=a.value.findIndex(s=>!s);t!==-1&&u(t)}}),T(()=>{o.autoFocus&&u(0)}),U(()=>{g.value&&clearInterval(g.value)}),B({clear:A,setValue:w,focus:()=>u(0)}),(e,t)=>{const s=F;return c(),d("div",Q,[y("div",W,[(c(!0),d(N,null,P(a.value,(n,l)=>J((c(),d("input",{key:l,ref_for:!0,ref:r=>x(r,l),"onUpdate:modelValue":r=>a.value[l]=r,type:"text",maxlength:"1",class:S(["w-12 h-12 text-center text-lg font-semibold border-2 rounded-lg","focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500","transition-colors duration-200",n?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-300 dark:border-gray-600",e.error?"border-red-500 bg-red-50 dark:bg-red-900/20":"","dark:bg-gray-700 dark:text-white"]),disabled:e.disabled,onInput:r=>j(l,r),onKeydown:r=>D(l,r),onPaste:E},null,42,X)),[[O,a.value[l]]])),128))]),e.error?(c(),d("div",Y,[y("p",Z,k(e.error),1)])):b("",!0),e.showResend?(c(),d("div",$,[i.value>0?(c(),d("div",ee,k(i.value)+" 秒后可重新发送 ",1)):(c(),L(s,{key:1,type:"text",loading:e.resending,onClick:M,class:"text-blue-600 hover:text-blue-500 dark:text-blue-400"},{default:z(()=>[...t[0]||(t[0]=[G(" 重新发送验证码 ",-1)])]),_:1},8,["loading"]))])):b("",!0),e.hint?(c(),d("div",te,[y("p",oe,k(e.hint),1)])):b("",!0)])}}}),re=q(ae,[["__scopeId","data-v-13786e5f"]]);export{re as V};
